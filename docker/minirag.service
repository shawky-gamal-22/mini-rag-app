[Unit]
Description=MiniRAG Docker Service
After=network.target docker.service
Requires=docker.service

[Service]
Type=forking
RemainAfterExit=yes
User=github_user
Group=docker
WorkingDirectory=/home/github_user/workspace/mini-rag/docker
ExecStartPre=/bin/bash -c '/usr/bin/docker compose down || true'
ExecStartPre=/bin/sleep 5
ExecStart=/usr/bin/docker compose up --build -d
ExecStop=/usr/bin/docker compose down
ExecReload=/usr/bin/docker compose restart
TimeoutStartSec=300
TimeoutStopSec=120
Restart=on-failure
RestartSec=10

[Install]
WantedBy=multi-user.target